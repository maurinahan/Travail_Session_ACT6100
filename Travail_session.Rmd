---
title: "Travail_Session_1_ACT6100"
author: "Maurin AHANHANZO & Gamaliel FATAL"
date: "07/10/2021"
output: pdf_document
---
EDA steps :
-	Déterminer la problématique sur le jeu de données
* Maurin:
Qu'es ce qui différencie un pays riche d'un pays en voie de développement selon notre base de données ?
-	Outils de visualisation :
•	Histogramme
•	Corrélogrammes
•	ANOVA (variables)
•	Nuages de points
•	ACP
•	Clustering: K-means, Hierachical clustering (liens minimum, maximum, Ward)

```{r}
#### Importation des libraries
library("dplyr")
library("tidyverse")
library("FactoMineR")
library("factoextra")
library("ggplot2")
library("corrplot")
library("GGally")  
```

```{r}
### Apercu de la base de données
df <- read.csv("C:/Users/mauac/Desktop/ACT6100/Country-data.csv")
head(df)
```
```{r}
### dimension de la base de données:
dim(df)
```

```{r}
### 
colnames(df)
```
Explication des colonnes:

- Country: 
- Child_mort: Décès d'enfants de moins de 5 ans pour 1000 naissances

- Exports : Exportations de biens et services par habitant (en pourcentage du PIB par habitant).

- Health: Dépenses totales de santé par habitant  (en pourcentage du PIB par habitant).

- Imports: Importations de biens et services par habitant (en pourcentage du PIB par habitant).

- Income: Revenu net moyen par personne.

- Inflation: La mesure du taux de croissance annuel du PIB total.

- Life expec : Espérance de vie moyenne à la naissance.

- Total_fer: le nombre d'enfants moyen par femme en âge de procréation.

- GDP: PIB par habitant.
```{r}
#### Vérification si df à des valeurs manquantes:
apply(df, 2, function(x) sum(is.na(x)))
```


```{r}
str(df)
```

```{r}
## Statistiques descriptives des variables numeriques:
df %>% 
  select_if(is.numeric) %>% 
  summary()
```
Comme conclusion de cette analyse, on peut dire:
- Nos variables numériques ne sont pas tous sur la même échelle de valeur. On a gdpp et income qui ont de grandes valeurs comparées aux autres variables.


```{r}
#### Matrice de corrélation.
### Affichons la matrice de correlation pour les variables dont la valeur 
### absolue de la corrélation est supérieure à 0.5

df_num<-df %>% 
  select_if(is.numeric)
R = cor(df_num)
#prepare to drop duplicates and correlations of 1     
R[lower.tri(R,diag=TRUE)] <- NA 
#drop perfect correlations
R[R == 1] <- NA 

sig = 0.5
#turn into a 3-column table
corr <- as.data.frame(as.table(R))
#remove the NA values from above 
corr <- na.omit(corr) 
#select significant values  
corr <- subset(corr, abs(Freq) > sig) 
#sort by highest correlation
corr <- corr[order(-abs(corr$Freq)),] 
#print table
print(corr)
#turn corr back into matrix in order to plot with corrplot
library("reshape2")
mtx_corr <- acast(corr, Var1~Var2, value.var="Freq")
#plot correlations visually
corrplot(mtx_corr, is.corr=FALSE, tl.col="black", na.label=" ")
```

On en ressort dix couples de variables dont la corrélation en valeur absolue entre elles sont supérieures à 0.5. Visualisons les:

```{r}
ggplot(df,aes(x=log(income), y=log(gdpp)))+geom_point()+geom_smooth(method = "lm")

```

On voit que income et gdpp sont fortement correlés positivement. On peut conclure au vu de ce graphique qu'un pays avec un revenu net moyen par personne à tendance à avoir un PIB élevé et vice-versa.


```{r}
ggplot(df,aes(x=child_mort, y=life_expec))+geom_point()+geom_smooth(method=lm)

```

On voit que child_mort et life_expec sont fortement correlés négativement. On peut conclure au vu de ce graphique qu'un pays avec un taux de mortalité infantile élevé à tendance à avoir une espérance de vie moyenne par personne faible et un pays avec espérance de vie moyenne par personne élevée à tendance à avoir une espérance de vie faible.

```{r}
ggplot(df,aes(x=child_mort, y=total_fer))+geom_point()+geom_smooth(method=lm)

```

On voit que child_mort et total_fer sont fortement correlés positivement. On peut conclure qu'au vu de ce graphique qu'un pays avec un taux de mortalité infantile élevé à tendance à avoir un taux de fécondité élevé moyen par femme et vice-versa.

```{r}
ggplot(df,aes(x=exports, y=imports))+geom_point()+geom_smooth(method=lm)

```
On voit que exports et imports sont fortement liés positivement. On peut conclure qu'au vu de ce graphique qu'un pays qui exporte beaucoup à tendance à importer beaucoup également.

```{r}
ggplot(df,aes(x=log(income), y=life_expec))+geom_point()+geom_smooth(method=lm)
```
On voit que income et life_exp sont corrélés positivement. On peut conclure qu'au vu de ce graphique qu'un pays avec un revenu net moyen par personne élevé à tendance à avoir une espérance de vie moyenne élevée.


```{r}
ggplot(df,aes(x=life_expec, y=log(gdpp)))+geom_point()+geom_smooth(method=lm)
```
On voit que gdpp et life_exp sont corrélés positivement. On peut conclure qu'au vu de ce graphique qu'un pays avec une espérance de vie moyenne élevée à tendance à avoir un PIB élevé. Ceci est pertinent puisque income et gdpp sont fortement correlés entre eux et income est correlés avec life_expec.

```{r}
ggplot(df,aes(x=child_mort, y=log(income)))+geom_point()+geom_smooth(method=lm)
```
On voit que child_mort et gdpp sont fortement corrélés négativement. On peut conclure qu'au vu de ce graphique qu'un pays avec un taux de mortalité infantile élevé à tendance à avoir un PIB faible.


```{r}
ggplot(df,aes(x=exports, y=log(income)))+geom_point()+geom_smooth(method=lm)

```
On voit que exports et income sont corrélés positivement. On peut conclure qu'au vu de ce graphique qu'un pays qui exporte beaucoup à tendance à avoir avoir un revenu net par personne élevé.Mais c'est pas toujours le cas, on constate sur le graphique qu'il ya des pays avec un revenu net moyen par personne élevé qui n'exportent pas beaucoup.

```{r}
ggplot(df,aes(x=log(income), y=total_fer))+geom_point()+geom_smooth(method = "loess")

```
On voit que income et total_fer sont corrélés négativement. On peut conclure qu'au vu de ce graphique qu'un pays avec un revenu net moyen par personne élevé à tendance à avoir un taux de fécondité moyen faible mais c'est pas toujours le cas, on constate sur le graphiqu'il ya des pays avec un revenu net moyen par personne élevé qui ont un taux de fécondité élevé également.


```{r}
df_norm <-
  df_num %>%
  mutate_all(scale)
rownames(df_norm)<-df[,1]
head(df_norm)
```


```{r}
acp<-PCA(df_norm,graph = FALSE)
print(fviz_pca_ind(acp)) 
```

```{r}
print(fviz_pca_var(acp))
```

```{r}
acp$var$coord
```
```{r}
 fviz_contrib(acp, "var", axes = c(1,2))
```

```{r}
fviz_pca_biplot(acp, pointsize = "cos2", col.var = "cos2")

```

```{r}
acp$var$coord
```

```{r}
acp[["eig"]][ , 1]
fviz_eig(acp)

```

```{r}
fviz_pca_ind(acp, col.ind = "contrib")
```

```{r}
hc <- HCPC(df_norm, nb.clust = 2)

```
```{r}
fviz_dend(hc)
fviz_cluster(hc, ggtheme = theme_bw())
```

```{r}
cor(acp$ind$coord[,"Dim.2"],df["exports"]-df["imports"])
```
```{r}
cbind(df["imports"], df["exports"],balance_com = df["exports"]-df["imports"])
```
```{r}
df_1<-as.data.frame(acp$ind$coord[,1:2])
df_1["balance_com"]<-df$balance_com
ggplot(df_1,aes(x=Dim.1, y=Dim.2, col=balance_com))+geom_point()+geom_smooth(method=lm)
```
```{r}
dat<-hc$data.clust
dat %>% 
  group_by(clust) %>% 
  summarise(moy_gdpp = mean(gdpp))
```

```{r}
df[dat["clust"]==1,1]
dat[df$country=="Benin","gdpp"]
# df[58,]
```


